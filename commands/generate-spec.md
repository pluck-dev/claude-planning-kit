# /generate-spec - 기능명세서 자동 생성

프로젝트의 기능명세서를 인터랙티브하게 작성합니다. **고객 미팅용**과 **개발용** 2가지 버전을 생성합니다.

## 수행 절차

### Phase 1: 프로젝트 파악

1. 현재 프로젝트의 코드베이스를 탐색합니다:
   - `package.json`, `README.md`, `CLAUDE.md` 등 프로젝트 메타 정보
   - 프레임워크/기술 스택 파악 (Next.js, React, Express, NestJS 등)
   - DB 스키마 (`prisma/schema.prisma`, `schema.sql`, `migrations/` 등)
   - API 라우트 구조 (`src/app/api/`, `src/routes/`, `pages/api/` 등)
   - 서비스 레이어 (`src/services/`, `src/lib/` 등)
   - 페이지/컴포넌트 구조

2. 기존 문서가 있는지 확인합니다:
   - `docs/`, `docs/functional-spec/`, `docs/spec/` 등

### Phase 2: 사용자 인터뷰 (AskUserQuestion 활용)

코드만으로 파악하기 어려운 비즈니스 컨텍스트를 질문합니다:

**질문 1 - 프로젝트 개요:**
- 이 프로젝트의 핵심 목적은 무엇인가요?
- 주요 사용자(타겟)는 누구인가요?

**질문 2 - 역할/권한:**
- 시스템에 어떤 사용자 역할이 있나요? (관리자, 일반 사용자, 딜러 등)
- 역할별 주요 기능 차이는?

**질문 3 - 핵심 기능:**
- 가장 중요한 비즈니스 기능 3-5개는?
- 특별한 업무 플로우가 있나요? (승인 프로세스, 결제 등)

**질문 4 - 고객 미팅 관련:**
- 고객에게 특별히 강조하고 싶은 기능이 있나요?
- 고객이 기술적 배경이 있나요, 없나요?

**질문 5 - 추가 요구사항:**
- 외부 연동 시스템이 있나요? (결제, SMS, 이메일 등)
- 향후 추가 예정 기능이 있나요?

### Phase 3: 문서 생성

`docs/functional-spec/` 디렉토리에 2가지 버전을 생성합니다:

#### A. 고객 미팅용 (`docs/client-spec/`)
비기술자도 이해할 수 있는 형식:
- **시스템 개요**: 프로젝트 목적, 기대 효과
- **주요 기능 소개**: 스크린샷/화면 흐름 중심, 기술 용어 최소화
- **사용자 역할**: 각 역할이 할 수 있는 일
- **업무 흐름도**: 핵심 프로세스 시각화 (Mermaid 다이어그램)
- **데이터 관리**: 어떤 데이터를 관리하는지 (비기술 용어)
- **일정/마일스톤**: 개발 단계 (Phase별)

#### B. 개발용 (`docs/functional-spec/`)
개발자가 바로 코드를 작성할 수 있는 수준:
- **목차** (`00-목차.md`)
- **시스템 개요** (`01-시스템-개요.md`): 기술 스택, 아키텍처, DB 구조
- **역할별 권한** (`02-역할별-권한.md`): 권한 매트릭스, API 접근 제어
- **인증 시스템** (`03-인증-시스템.md`): 로그인/로그아웃, JWT, 세션 관리
- 각 도메인별 상세 명세서: 데이터 모델(필드/타입/nullable/기본값), API 엔드포인트, 비즈니스 로직, 에러 처리

### Phase 4: 동기화 설정

1. `CLAUDE.md`에 문서 동기화 규칙 추가 (없으면 생성)
2. 코드-문서 매핑표 작성

## 출력 형식

모든 문서는 **한국어 마크다운**으로 작성합니다. 기술 용어(API, DB, JWT 등)는 영문 그대로 사용합니다.

## 중요 원칙

- 코드에서 확인 가능한 내용은 반드시 실제 코드를 읽어서 작성합니다.
- 추측이 아닌 코드 기반 사실만 기술합니다.
- 코드에 없지만 사용자가 언급한 기능은 "예정 기능"으로 별도 표시합니다.
- 고객 미팅용은 Mermaid 다이어그램을 적극 활용합니다.
- 개발용은 데이터 모델 테이블(필드명, 타입, nullable, 기본값, 설명)을 반드시 포함합니다.
